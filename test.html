<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>保存为 SVG</title>
</head>
<body>
<button id="svg">导出SVG</button>
<canvas id="c"></canvas>
<script src="./bower_components/jQuery/dist/jquery.js"></script>
<script src="./bower_components/fabric.js/dist/fabric.js"></script>
<script>
  fabric.Object.prototype.transparentCorners = false;
  var canvas = new fabric.Canvas('c', { width: 800, height: 800, backgroundColor: 'pink' });
  var str = `
  <?xml version="1.0" encoding="UTF-8" standalone="no" ?>
  <!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
  <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="500" height="300" viewBox="0 0 500 300" xml:space="preserve">
  <desc>Created with Fabric.js 2.4.4</desc>
  <defs>
  </defs>
  <rect x="0" y="0" width="100%" height="100%" fill="#ccc"></rect>
  <g transform="matrix(1 0 0 1 35.5 35.5)"  >
  <rect style="stroke: none; stroke-width: 1; stroke-dasharray: none; stroke-linecap: butt; stroke-dashoffset: 0; stroke-linejoin: miter; stroke-miterlimit: 4; fill: rgb(255,0,0); fill-rule: nonzero; opacity: 1;"  x="-25" y="-25" rx="0" ry="0" width="50" height="50" />
  </g>
  </svg>
  `;
  fabric.loadSVGFromString(str, function(objects, options) {
      // Group elements to fabric.PathGroup (more than 1 elements) or
      // to fabric.Path
      var loadedObject = fabric.util.groupSVGElements(objects, options);
      // Set sourcePath
      // loadedObject.set('sourcePath', elem.getAttribute('data-url'));
      console.log(objects, 8899)
      canvas.add.apply(canvas, objects);
      canvas.renderAll();
      // canvas.add(loadedObject);
      // loadedObject.center().setCoords();
      // canvas.renderAll();
  });
  // var json = '{"version":"2.4.4","objects":[{"type":"rect","version":"2.4.4","originX":"left","originY":"top","left":70,"top":48,"width":50,"height":50,"fill":"red","stroke":null,"strokeWidth":1,"strokeDashArray":null,"strokeLineCap":"butt","strokeDashOffset":0,"strokeLineJoin":"miter","strokeMiterLimit":4,"scaleX":2.72,"scaleY":2.72,"angle":0,"flipX":false,"flipY":false,"opacity":1,"shadow":null,"visible":true,"clipTo":null,"backgroundColor":"","fillRule":"nonzero","paintFirst":"fill","globalCompositeOperation":"source-over","transformMatrix":null,"skewX":0,"skewY":0,"rx":0,"ry":0},{"type":"circle","version":"2.4.4","originX":"left","originY":"top","left":350,"top":62,"width":50,"height":50,"fill":"yellow","stroke":null,"strokeWidth":1,"strokeDashArray":null,"strokeLineCap":"butt","strokeDashOffset":0,"strokeLineJoin":"miter","strokeMiterLimit":4,"scaleX":1,"scaleY":2.38,"angle":0,"flipX":false,"flipY":false,"opacity":1,"shadow":null,"visible":true,"clipTo":null,"backgroundColor":"","fillRule":"nonzero","paintFirst":"fill","globalCompositeOperation":"source-over","transformMatrix":null,"skewX":0,"skewY":0,"radius":25,"startAngle":0,"endAngle":6.283185307179586}],"background":"#ccc"}';
  // canvas.loadFromJSON(json, canvas.renderAll.bind(canvas), function(o, object) {
  //   fabric.log(o, object);
  // });
  // var rect = new fabric.Rect({ top: 10, left: 10, width: 50, height: 50, fill: 'red' });
  // var circle = new fabric.Circle({ radius: 25, fill: 'yellow' });
  // canvas.add(rect, circle);
  // fabric.loadSVGFromURL('images/tt.svg', function(objects, options) {
  //   var dollars = fabric.util.groupSVGElements(objects, options);
  //   canvas.add(dollars);
  //   canvas.calcOffset();
  //   canvas.renderAll();
  // });

  // $('#svg').click(function () {
  //   var str = canvas.toJSON();
  //   console.log(JSON.stringify(str));
  // });
</script>
</body>
</html>
